axis(side=2, at=t1(1:5), labels=1:5, las=1, col=NA, col.ticks=1)
mtext("Trophic level", side=2, outer=TRUE, line=0, cex=1.25, font=2)
par(fig=c(0,1,0,1), family="Lato", new=TRUE)
# Plots title
plot(0, 0, type="n", bty="n", xaxt="n", yaxt="n")
mtext("Potter Cove", side=3, outer=TRUE, line=0.5, cex=1.75, font=2, adj=0)
par(fig=c(0,1,0,1), oma=c(0,0,0,0), mar=c(0,0,1,0), new=TRUE)
dev.off()
# BEAGLE plot
#svg("2020/Figures/fwb_mod_topo.svg", width=10, height=10)
tiff("2020/Figures/fwb.tif", width=10, height=10, units="in", res=300)
par(mfrow=c(1,1), mar=c(0,2,0,0), oma=c(0,1.5,2.3,0.5), family = "Lato")
plot(b,
vertex.color=vertex_attr(b)$cor,
vertex.label=NA,
vertex.size=log(10*igraph::degree(b)),
edge.width=.3,
edge.arrow.size=.5,
edge.color=add.alpha("grey55", 0.5),
edge.curved=0.2,
layout=layout.matrix.2)
# Add axis-y text & title
axis(side=2, at=t2(1:5), labels=1:5, las=1, col=NA, col.ticks=1)
mtext("Trophic level", side=2, outer=TRUE, line=0, cex=1.25, font=2)
par(fig=c(0,1,0,1), family="Lato", new=TRUE)
# Plots title
plot(0, 0, type="n", bty="n", xaxt="n", yaxt="n")
mtext("Beagle Channel", side=3, outer=TRUE, line=0.5, cex=1.75, font=2, adj=1)
par(fig=c(0,1,0,1), family="Lato", new=TRUE)
dev.off()
#svg("2020/Figures/fw_legend.svg", width=5, height=5)
#par(mfrow=c(1,1), mar=c(0,2,0,0), oma=c(0,1.5,2.3,0.5), family = "Lato")
# Add legend
#plot(0, 0, type="n", bty="n", xaxt="n", yaxt="n")
#legend("top", legend = c("Network connector", "Module connector", "Module hub", "Module specialist"), col=colnet, pch=19, cex=1, xpd=TRUE, inset=c(0,0), title="Topological roles:")
#dev.off()
#---- Plot fw by TL and mod
troph.net1 <- TrophInd(get.adjacency(p, sparse=F), Dead=c("Necromass", "Fresh detritus", "Aged detritus"))
layout.matrix.1 <- matrix(nrow=length(V(p)), ncol=2)
troph.net2 <- TrophInd(get.adjacency(b, sparse=F), Dead=c("Necromass", "Fresh detritus", "Aged detritus"))
layout.matrix.2 <- matrix(nrow=length(V(b)), ncol=2)
# Add colors with topological roles to nodes
require(RColorBrewer)
colnet <- brewer.pal(4,"PRGn")
hcp <- hub_connp %>% mutate(type = factor(type)) %>% arrange(node) %>% mutate(col=as.numeric(type), TL=troph.net1[,1])
V(p)$color <- colnet[hcp$col]
hcb <- hub_connb %>% mutate(type = factor(type)) %>% arrange(node) %>% mutate(col=as.numeric(type), TL=troph.net2[,1])
V(b)$color <- colnet[hcb$col]
# Transform y-axis coordinates
maxnewp <- max(hcp$TL)
minnewp <- min(hcp$TL)
maxnewb <- max(hcb$TL)
minnewb <- min(hcb$TL)
maxold <- 1
minold <- -1
t1 <- function(x) (maxold-minold)/(maxnewp-minnewp)*(x-maxnewp)+maxold
t2 <- function(x) (maxold-minold)/(maxnewb-minnewb)*(x-maxnewb)+maxold
# Plot modules
layout.matrix.1[,2] <- jitter(troph.net1$TL, 0.4) # y-axis value based on trophic level
layout.matrix.1[,1] <- jitter(mod_by_red[[1]]$membership, 1) # randomly assign along x-axis
layout.matrix.2[,2] <- jitter(troph.net2$TL, 0.4) # y-axis value based on trophic level
layout.matrix.2[,1] <- jitter(mod_by_red[[2]]$membership, 1) # randomly assign along x-axis
# POTTER plot
#svg("2020/Figures/fwp_mod_topo.svg", width=10, height=10)
tiff("2020/Figures/fwp.tif", width=10, height=10, units="in", res=300)
par(mfrow=c(1,1), mar=c(0,2,0,0), oma=c(0,1.5,2.3,0.5), family = "Lato")
require(prettyGraphs)
plot(p,
vertex.color=vertex_attr(p)$cor,
vertex.label=NA,
vertex.size=log(10*igraph::degree(p)),
edge.width=.3,
edge.arrow.size=.5,
edge.color=add.alpha("grey55", 0.5),
edge.curved=0.2,
layout=layout.matrix.1)
# Add axis-y text & title
axis(side=2, at=t1(1:5), labels=1:5, las=1, col=NA, col.ticks=1)
mtext("Trophic level", side=2, outer=TRUE, line=0, cex=1.25, font=2)
par(fig=c(0,1,0,1), family="Lato", new=TRUE)
# Plots title
plot(0, 0, type="n", bty="n", xaxt="n", yaxt="n")
mtext("Potter Cove", side=3, outer=TRUE, line=0.5, cex=1.75, font=2, adj=0)
par(fig=c(0,1,0,1), oma=c(0,0,0,0), mar=c(0,0,1,0), new=TRUE)
dev.off()
# BEAGLE plot
#svg("2020/Figures/fwb_mod_topo.svg", width=10, height=10)
tiff("2020/Figures/fwb.tif", width=10, height=10, units="in", res=300)
par(mfrow=c(1,1), mar=c(0,2,0,0), oma=c(0,1.5,2.3,0.5), family = "Lato")
plot(b,
vertex.color=vertex_attr(b)$cor,
vertex.label=NA,
vertex.size=log(10*igraph::degree(b)),
edge.width=.3,
edge.arrow.size=.5,
edge.color=add.alpha("grey55", 0.5),
edge.curved=0.2,
layout=layout.matrix.2)
# Add axis-y text & title
axis(side=2, at=t2(1:5), labels=1:5, las=1, col=NA, col.ticks=1)
mtext("Trophic level", side=2, outer=TRUE, line=0, cex=1.25, font=2)
par(fig=c(0,1,0,1), family="Lato", new=TRUE)
# Plots title
plot(0, 0, type="n", bty="n", xaxt="n", yaxt="n")
mtext("Beagle Channel", side=3, outer=TRUE, line=0.5, cex=1.75, font=2, adj=1)
par(fig=c(0,1,0,1), family="Lato", new=TRUE)
dev.off()
#svg("2020/Figures/fw_legend.svg", width=5, height=5)
#par(mfrow=c(1,1), mar=c(0,2,0,0), oma=c(0,1.5,2.3,0.5), family = "Lato")
# Add legend
#plot(0, 0, type="n", bty="n", xaxt="n", yaxt="n")
#legend("top", legend = c("Network connector", "Module connector", "Module hub", "Module specialist"), col=colnet, pch=19, cex=1, xpd=TRUE, inset=c(0,0), title="Topological roles:")
#dev.off()
#---- Plot fw by TL and mod
troph.net1 <- TrophInd(get.adjacency(p, sparse=F), Dead=c("Necromass", "Fresh detritus", "Aged detritus"))
layout.matrix.1 <- matrix(nrow=length(V(p)), ncol=2)
troph.net2 <- TrophInd(get.adjacency(b, sparse=F), Dead=c("Necromass", "Fresh detritus", "Aged detritus"))
layout.matrix.2 <- matrix(nrow=length(V(b)), ncol=2)
# Add colors with topological roles to nodes
require(RColorBrewer)
colnet <- brewer.pal(4,"PRGn")
hcp <- hub_connp %>% mutate(type = factor(type)) %>% arrange(node) %>% mutate(col=as.numeric(type), TL=troph.net1[,1])
V(p)$color <- colnet[hcp$col]
hcb <- hub_connb %>% mutate(type = factor(type)) %>% arrange(node) %>% mutate(col=as.numeric(type), TL=troph.net2[,1])
V(b)$color <- colnet[hcb$col]
# Transform y-axis coordinates
maxnewp <- max(hcp$TL)
minnewp <- min(hcp$TL)
maxnewb <- max(hcb$TL)
minnewb <- min(hcb$TL)
maxold <- 1
minold <- -1
t1 <- function(x) (maxold-minold)/(maxnewp-minnewp)*(x-maxnewp)+maxold
t2 <- function(x) (maxold-minold)/(maxnewb-minnewb)*(x-maxnewb)+maxold
# Plot modules
layout.matrix.1[,2] <- jitter(troph.net1$TL, 0.4) # y-axis value based on trophic level
layout.matrix.1[,1] <- jitter(mod_by_red[[1]]$membership, 1.2) # randomly assign along x-axis
layout.matrix.2[,2] <- jitter(troph.net2$TL, 0.4) # y-axis value based on trophic level
layout.matrix.2[,1] <- jitter(mod_by_red[[2]]$membership, 1) # randomly assign along x-axis
# POTTER plot
#svg("2020/Figures/fwp_mod_topo.svg", width=10, height=10)
tiff("2020/Figures/fwp.tif", width=10, height=10, units="in", res=300)
par(mfrow=c(1,1), mar=c(0,2,0,0), oma=c(0,1.5,2.3,0.5), family = "Lato")
require(prettyGraphs)
plot(p,
vertex.color=vertex_attr(p)$cor,
vertex.label=NA,
vertex.size=log(30*igraph::degree(p)),
edge.width=.3,
edge.arrow.size=.5,
edge.color=add.alpha("grey55", 0.5),
edge.curved=0.2,
layout=layout.matrix.1)
# Add axis-y text & title
axis(side=2, at=t1(1:5), labels=1:5, las=1, col=NA, col.ticks=1)
mtext("Trophic level", side=2, outer=TRUE, line=0, cex=1.25, font=2)
par(fig=c(0,1,0,1), family="Lato", new=TRUE)
# Plots title
plot(0, 0, type="n", bty="n", xaxt="n", yaxt="n")
mtext("Potter Cove", side=3, outer=TRUE, line=0.5, cex=1.75, font=2, adj=0)
par(fig=c(0,1,0,1), oma=c(0,0,0,0), mar=c(0,0,1,0), new=TRUE)
dev.off()
# BEAGLE plot
#svg("2020/Figures/fwb_mod_topo.svg", width=10, height=10)
tiff("2020/Figures/fwb.tif", width=10, height=10, units="in", res=300)
par(mfrow=c(1,1), mar=c(0,2,0,0), oma=c(0,1.5,2.3,0.5), family = "Lato")
plot(b,
vertex.color=vertex_attr(b)$cor,
vertex.label=NA,
vertex.size=log(15*igraph::degree(b)),
edge.width=.3,
edge.arrow.size=.5,
edge.color=add.alpha("grey55", 0.5),
edge.curved=0.2,
layout=layout.matrix.2)
# Add axis-y text & title
axis(side=2, at=t2(1:5), labels=1:5, las=1, col=NA, col.ticks=1)
mtext("Trophic level", side=2, outer=TRUE, line=0, cex=1.25, font=2)
par(fig=c(0,1,0,1), family="Lato", new=TRUE)
# Plots title
plot(0, 0, type="n", bty="n", xaxt="n", yaxt="n")
mtext("Beagle Channel", side=3, outer=TRUE, line=0.5, cex=1.75, font=2, adj=1)
par(fig=c(0,1,0,1), family="Lato", new=TRUE)
dev.off()
#svg("2020/Figures/fw_legend.svg", width=5, height=5)
#par(mfrow=c(1,1), mar=c(0,2,0,0), oma=c(0,1.5,2.3,0.5), family = "Lato")
# Add legend
#plot(0, 0, type="n", bty="n", xaxt="n", yaxt="n")
#legend("top", legend = c("Network connector", "Module connector", "Module hub", "Module specialist"), col=colnet, pch=19, cex=1, xpd=TRUE, inset=c(0,0), title="Topological roles:")
#dev.off()
layout.matrix.2[,2] <- jitter(troph.net2$TL, 0.4) # y-axis value based on trophic level
layout.matrix.2[,1] <- jitter(mod_by_red[[2]]$membership, 1) # randomly assign along x-axis
#svg("2020/Figures/fwb_mod_topo.svg", width=10, height=10)
tiff("2020/Figures/fwb.tif", width=10, height=10, units="in", res=300)
par(mfrow=c(1,1), mar=c(0,2,0,0), oma=c(0,1.5,2.3,0.5), family = "Lato")
plot(b,
vertex.color=vertex_attr(b)$cor,
vertex.label=NA,
vertex.size=ligraph::degree(b),
edge.width=.3,
edge.arrow.size=.5,
edge.color=add.alpha("grey55", 0.5),
edge.curved=0.2,
layout=layout.matrix.2)
# Add axis-y text & title
axis(side=2, at=t2(1:5), labels=1:5, las=1, col=NA, col.ticks=1)
mtext("Trophic level", side=2, outer=TRUE, line=0, cex=1.25, font=2)
par(fig=c(0,1,0,1), family="Lato", new=TRUE)
# Plots title
plot(0, 0, type="n", bty="n", xaxt="n", yaxt="n")
mtext("Beagle Channel", side=3, outer=TRUE, line=0.5, cex=1.75, font=2, adj=1)
par(fig=c(0,1,0,1), family="Lato", new=TRUE)
dev.off()
layout.matrix.2[,2] <- jitter(troph.net2$TL, 0.4) # y-axis value based on trophic level
layout.matrix.2[,1] <- jitter(mod_by_red[[2]]$membership, 1) # randomly assign along x-axis
#svg("2020/Figures/fwb_mod_topo.svg", width=10, height=10)
tiff("2020/Figures/fwb.tif", width=10, height=10, units="in", res=300)
par(mfrow=c(1,1), mar=c(0,2,0,0), oma=c(0,1.5,2.3,0.5), family = "Lato")
plot(b,
vertex.color=vertex_attr(b)$cor,
vertex.label=NA,
vertex.size=igraph::degree(b),
edge.width=.3,
edge.arrow.size=.5,
edge.color=add.alpha("grey55", 0.5),
edge.curved=0.2,
layout=layout.matrix.2)
# Add axis-y text & title
axis(side=2, at=t2(1:5), labels=1:5, las=1, col=NA, col.ticks=1)
mtext("Trophic level", side=2, outer=TRUE, line=0, cex=1.25, font=2)
par(fig=c(0,1,0,1), family="Lato", new=TRUE)
# Plots title
plot(0, 0, type="n", bty="n", xaxt="n", yaxt="n")
mtext("Beagle Channel", side=3, outer=TRUE, line=0.5, cex=1.75, font=2, adj=1)
par(fig=c(0,1,0,1), family="Lato", new=TRUE)
dev.off()
layout.matrix.2[,2] <- jitter(troph.net2$TL, 0.4) # y-axis value based on trophic level
layout.matrix.2[,1] <- jitter(mod_by_red[[2]]$membership, 1) # randomly assign along x-axis
#svg("2020/Figures/fwb_mod_topo.svg", width=10, height=10)
tiff("2020/Figures/fwb.tif", width=10, height=10, units="in", res=300)
par(mfrow=c(1,1), mar=c(0,2,0,0), oma=c(0,1.5,2.3,0.5), family = "Lato")
plot(b,
vertex.color=vertex_attr(b)$cor,
vertex.label=NA,
vertex.size=log10(degree(b)),
edge.width=.3,
edge.arrow.size=.5,
edge.color=add.alpha("grey55", 0.5),
edge.curved=0.2,
layout=layout.matrix.2)
# Add axis-y text & title
axis(side=2, at=t2(1:5), labels=1:5, las=1, col=NA, col.ticks=1)
mtext("Trophic level", side=2, outer=TRUE, line=0, cex=1.25, font=2)
par(fig=c(0,1,0,1), family="Lato", new=TRUE)
# Plots title
plot(0, 0, type="n", bty="n", xaxt="n", yaxt="n")
mtext("Beagle Channel", side=3, outer=TRUE, line=0.5, cex=1.75, font=2, adj=1)
par(fig=c(0,1,0,1), family="Lato", new=TRUE)
dev.off()
plot(b,
vertex.color=vertex_attr(b)$cor,
vertex.label=NA,
vertex.size=log10(degree(b))*5,
edge.width=.3,
edge.arrow.size=.5,
edge.color=add.alpha("grey55", 0.5),
edge.curved=0.2,
layout=layout.matrix.2)
layout.matrix.2[,2] <- jitter(troph.net2$TL, 0.4) # y-axis value based on trophic level
layout.matrix.2[,1] <- jitter(mod_by_red[[2]]$membership, 1) # randomly assign along x-axis
#svg("2020/Figures/fwb_mod_topo.svg", width=10, height=10)
tiff("2020/Figures/fwb.tif", width=10, height=10, units="in", res=300)
par(mfrow=c(1,1), mar=c(0,2,0,0), oma=c(0,1.5,2.3,0.5), family = "Lato")
plot(b,
vertex.color=vertex_attr(b)$cor,
vertex.label=NA,
vertex.size=log10(degree(b))*50,
edge.width=.3,
edge.arrow.size=.5,
edge.color=add.alpha("grey55", 0.5),
edge.curved=0.2,
layout=layout.matrix.2)
# Add axis-y text & title
axis(side=2, at=t2(1:5), labels=1:5, las=1, col=NA, col.ticks=1)
mtext("Trophic level", side=2, outer=TRUE, line=0, cex=1.25, font=2)
par(fig=c(0,1,0,1), family="Lato", new=TRUE)
# Plots title
plot(0, 0, type="n", bty="n", xaxt="n", yaxt="n")
mtext("Beagle Channel", side=3, outer=TRUE, line=0.5, cex=1.75, font=2, adj=1)
par(fig=c(0,1,0,1), family="Lato", new=TRUE)
dev.off()
layout.matrix.2[,2] <- jitter(troph.net2$TL, 0.4) # y-axis value based on trophic level
layout.matrix.2[,1] <- jitter(mod_by_red[[2]]$membership, 1) # randomly assign along x-axis
#svg("2020/Figures/fwb_mod_topo.svg", width=10, height=10)
tiff("2020/Figures/fwb.tif", width=10, height=10, units="in", res=300)
par(mfrow=c(1,1), mar=c(0,2,0,0), oma=c(0,1.5,2.3,0.5), family = "Lato")
plot(b,
vertex.color=vertex_attr(b)$cor,
vertex.label=NA,
vertex.size=log10(degree(b))*5,
edge.width=.3,
edge.arrow.size=.5,
edge.color=add.alpha("grey55", 0.5),
edge.curved=0.2,
layout=layout.matrix.2)
# Add axis-y text & title
axis(side=2, at=t2(1:5), labels=1:5, las=1, col=NA, col.ticks=1)
mtext("Trophic level", side=2, outer=TRUE, line=0, cex=1.25, font=2)
par(fig=c(0,1,0,1), family="Lato", new=TRUE)
# Plots title
plot(0, 0, type="n", bty="n", xaxt="n", yaxt="n")
mtext("Beagle Channel", side=3, outer=TRUE, line=0.5, cex=1.75, font=2, adj=1)
par(fig=c(0,1,0,1), family="Lato", new=TRUE)
dev.off()
layout.matrix.2[,2] <- jitter(troph.net2$TL, 0.4) # y-axis value based on trophic level
layout.matrix.2[,1] <- jitter(mod_by_red[[2]]$membership, 1) # randomly assign along x-axis
#svg("2020/Figures/fwb_mod_topo.svg", width=10, height=10)
tiff("2020/Figures/fwb.tif", width=10, height=10, units="in", res=300)
par(mfrow=c(1,1), mar=c(0,2,0,0), oma=c(0,1.5,2.3,0.5), family = "Lato")
plot(b,
vertex.color=vertex_attr(b)$cor,
vertex.label=NA,
vertex.size=log10(degree(b))*9,
edge.width=.3,
edge.arrow.size=.5,
edge.color=add.alpha("grey55", 0.5),
edge.curved=0.2,
layout=layout.matrix.2)
# Add axis-y text & title
axis(side=2, at=t2(1:5), labels=1:5, las=1, col=NA, col.ticks=1)
mtext("Trophic level", side=2, outer=TRUE, line=0, cex=1.25, font=2)
par(fig=c(0,1,0,1), family="Lato", new=TRUE)
# Plots title
plot(0, 0, type="n", bty="n", xaxt="n", yaxt="n")
mtext("Beagle Channel", side=3, outer=TRUE, line=0.5, cex=1.75, font=2, adj=1)
par(fig=c(0,1,0,1), family="Lato", new=TRUE)
dev.off()
layout.matrix.2[,2] <- jitter(troph.net2$TL, 0.4) # y-axis value based on trophic level
layout.matrix.2[,1] <- jitter(mod_by_red[[2]]$membership, 1) # randomly assign along x-axis
#svg("2020/Figures/fwb_mod_topo.svg", width=10, height=10)
tiff("2020/Figures/fwb.tif", width=10, height=10, units="in", res=300)
par(mfrow=c(1,1), mar=c(0,2,0,0), oma=c(0,1.5,2.3,0.5), family = "Lato")
plot(b,
vertex.color=vertex_attr(b)$cor,
vertex.label=NA,
vertex.size=log10(degree(b))*7,
edge.width=.3,
edge.arrow.size=.5,
edge.color=add.alpha("grey55", 0.5),
edge.curved=0.2,
layout=layout.matrix.2)
# Add axis-y text & title
axis(side=2, at=t2(1:5), labels=1:5, las=1, col=NA, col.ticks=1)
mtext("Trophic level", side=2, outer=TRUE, line=0, cex=1.25, font=2)
par(fig=c(0,1,0,1), family="Lato", new=TRUE)
# Plots title
plot(0, 0, type="n", bty="n", xaxt="n", yaxt="n")
mtext("Beagle Channel", side=3, outer=TRUE, line=0.5, cex=1.75, font=2, adj=1)
par(fig=c(0,1,0,1), family="Lato", new=TRUE)
dev.off()
layout.matrix.2[,2] <- jitter(troph.net2$TL, 0.4) # y-axis value based on trophic level
layout.matrix.2[,1] <- jitter(mod_by_red[[2]]$membership, 1) # randomly assign along x-axis
#svg("2020/Figures/fwb_mod_topo.svg", width=10, height=10)
tiff("2020/Figures/fwb.tif", width=10, height=10, units="in", res=300)
par(mfrow=c(1,1), mar=c(0,2,0,0), oma=c(0,1.5,2.3,0.5), family = "Lato")
plot(b,
vertex.color=vertex_attr(b)$cor,
vertex.label=NA,
vertex.size=log10(degree(b))*6,
edge.width=.3,
edge.arrow.size=.5,
edge.color=add.alpha("grey55", 0.5),
edge.curved=0.2,
layout=layout.matrix.2)
# Add axis-y text & title
axis(side=2, at=t2(1:5), labels=1:5, las=1, col=NA, col.ticks=1)
mtext("Trophic level", side=2, outer=TRUE, line=0, cex=1.25, font=2)
par(fig=c(0,1,0,1), family="Lato", new=TRUE)
# Plots title
plot(0, 0, type="n", bty="n", xaxt="n", yaxt="n")
mtext("Beagle Channel", side=3, outer=TRUE, line=0.5, cex=1.75, font=2, adj=1)
par(fig=c(0,1,0,1), family="Lato", new=TRUE)
dev.off()
layout.matrix.2[,2] <- jitter(troph.net2$TL, 0.4) # y-axis value based on trophic level
layout.matrix.2[,1] <- jitter(mod_by_red[[2]]$membership, 1) # randomly assign along x-axis
#svg("2020/Figures/fwb_mod_topo.svg", width=10, height=10)
tiff("2020/Figures/fwb.tif", width=10, height=10, units="in", res=300)
par(mfrow=c(1,1), mar=c(0,2,0,0), oma=c(0,1.5,2.3,0.5), family = "Lato")
plot(b,
vertex.color=vertex_attr(b)$cor,
vertex.label=NA,
vertex.size=log10(degree(b))*5.5,
edge.width=.3,
edge.arrow.size=.5,
edge.color=add.alpha("grey55", 0.5),
edge.curved=0.2,
layout=layout.matrix.2)
# Add axis-y text & title
axis(side=2, at=t2(1:5), labels=1:5, las=1, col=NA, col.ticks=1)
mtext("Trophic level", side=2, outer=TRUE, line=0, cex=1.25, font=2)
par(fig=c(0,1,0,1), family="Lato", new=TRUE)
# Plots title
plot(0, 0, type="n", bty="n", xaxt="n", yaxt="n")
mtext("Beagle Channel", side=3, outer=TRUE, line=0.5, cex=1.75, font=2, adj=1)
par(fig=c(0,1,0,1), family="Lato", new=TRUE)
dev.off()
layout.matrix.2[,2] <- jitter(troph.net2$TL, 0.4) # y-axis value based on trophic level
layout.matrix.2[,1] <- jitter(mod_by_red[[2]]$membership, 1.2) # randomly assign along x-axis
#svg("2020/Figures/fwb_mod_topo.svg", width=10, height=10)
tiff("2020/Figures/fwb.tif", width=10, height=10, units="in", res=300)
par(mfrow=c(1,1), mar=c(0,2,0,0), oma=c(0,1.5,2.3,0.5), family = "Lato")
plot(b,
vertex.color=vertex_attr(b)$cor,
vertex.label=NA,
vertex.size=log10(degree(b))*5.5,
edge.width=.3,
edge.arrow.size=.5,
edge.color=add.alpha("grey55", 0.5),
edge.curved=0.2,
layout=layout.matrix.2)
# Add axis-y text & title
axis(side=2, at=t2(1:5), labels=1:5, las=1, col=NA, col.ticks=1)
mtext("Trophic level", side=2, outer=TRUE, line=0, cex=1.25, font=2)
par(fig=c(0,1,0,1), family="Lato", new=TRUE)
# Plots title
plot(0, 0, type="n", bty="n", xaxt="n", yaxt="n")
mtext("Beagle Channel", side=3, outer=TRUE, line=0.5, cex=1.75, font=2, adj=1)
par(fig=c(0,1,0,1), family="Lato", new=TRUE)
dev.off()
layout.matrix.2[,2] <- jitter(troph.net2$TL, 0.4) # y-axis value based on trophic level
layout.matrix.2[,1] <- jitter(mod_by_red[[2]]$membership, 1.2) # randomly assign along x-axis
#svg("2020/Figures/fwb_mod_topo.svg", width=10, height=10)
tiff("2020/Figures/fwb.tif", width=10, height=10, units="in", res=300)
par(mfrow=c(1,1), mar=c(0,2,0,0), oma=c(0,1.5,2.3,0.5), family = "Lato")
plot(b,
vertex.color=vertex_attr(b)$cor,
vertex.label=NA,
vertex.size=log10(degree(b))*4,
edge.width=.3,
edge.arrow.size=.5,
edge.color=add.alpha("grey55", 0.5),
edge.curved=0.2,
layout=layout.matrix.2)
# Add axis-y text & title
axis(side=2, at=t2(1:5), labels=1:5, las=1, col=NA, col.ticks=1)
mtext("Trophic level", side=2, outer=TRUE, line=0, cex=1.25, font=2)
par(fig=c(0,1,0,1), family="Lato", new=TRUE)
# Plots title
plot(0, 0, type="n", bty="n", xaxt="n", yaxt="n")
mtext("Beagle Channel", side=3, outer=TRUE, line=0.5, cex=1.75, font=2, adj=1)
par(fig=c(0,1,0,1), family="Lato", new=TRUE)
dev.off()
layout.matrix.2[,2] <- jitter(troph.net2$TL, 0.4) # y-axis value based on trophic level
layout.matrix.2[,1] <- jitter(mod_by_red[[2]]$membership, 1.2) # randomly assign along x-axis
#svg("2020/Figures/fwb_mod_topo.svg", width=10, height=10)
tiff("2020/Figures/fwb.tif", width=10, height=10, units="in", res=300)
par(mfrow=c(1,1), mar=c(0,2,0,0), oma=c(0,1.5,2.3,0.5), family = "Lato")
plot(b,
vertex.color=vertex_attr(b)$cor,
vertex.label=NA,
vertex.size=log10(degree(b))*5,
edge.width=.3,
edge.arrow.size=.5,
edge.color=add.alpha("grey55", 0.5),
edge.curved=0.2,
layout=layout.matrix.2)
# Add axis-y text & title
axis(side=2, at=t2(1:5), labels=1:5, las=1, col=NA, col.ticks=1)
mtext("Trophic level", side=2, outer=TRUE, line=0, cex=1.25, font=2)
par(fig=c(0,1,0,1), family="Lato", new=TRUE)
# Plots title
plot(0, 0, type="n", bty="n", xaxt="n", yaxt="n")
mtext("Beagle Channel", side=3, outer=TRUE, line=0.5, cex=1.75, font=2, adj=1)
par(fig=c(0,1,0,1), family="Lato", new=TRUE)
dev.off()
layout.matrix.2[,2] <- jitter(troph.net2$TL, 0.4) # y-axis value based on trophic level
layout.matrix.2[,1] <- jitter(mod_by_red[[2]]$membership, 1.1) # randomly assign along x-axis
#svg("2020/Figures/fwb_mod_topo.svg", width=10, height=10)
tiff("2020/Figures/fwb.tif", width=10, height=10, units="in", res=300)
par(mfrow=c(1,1), mar=c(0,2,0,0), oma=c(0,1.5,2.3,0.5), family = "Lato")
plot(b,
vertex.color=vertex_attr(b)$cor,
vertex.label=NA,
vertex.size=log10(degree(b))*5,
edge.width=.3,
edge.arrow.size=.5,
edge.color=add.alpha("grey55", 0.5),
edge.curved=0.2,
layout=layout.matrix.2)
# Add axis-y text & title
axis(side=2, at=t2(1:5), labels=1:5, las=1, col=NA, col.ticks=1)
mtext("Trophic level", side=2, outer=TRUE, line=0, cex=1.25, font=2)
par(fig=c(0,1,0,1), family="Lato", new=TRUE)
# Plots title
plot(0, 0, type="n", bty="n", xaxt="n", yaxt="n")
mtext("Beagle Channel", side=3, outer=TRUE, line=0.5, cex=1.75, font=2, adj=1)
par(fig=c(0,1,0,1), family="Lato", new=TRUE)
dev.off()
knitr::opts_chunk$set(echo = TRUE)
load(".RData")
require(igraph)
require(NetIndices)
require(stringr)
require(dplyr)
require(ggplot2)
require(future.apply)
require(knitr)
require(purrr)
require(devtools)
require(multiweb)
require(cowplot)
require(RColorBrewer)
